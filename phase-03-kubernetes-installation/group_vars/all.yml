# Kubernetes Cluster Configuration Variables
# Phase 3: Kubernetes Installation

---
# Kubernetes Version
kubernetes_version: "{{ k8s_version }}"
kubernetes_version_rhel_package: "{{ k8s_version_rhel_package }}"

# Container Runtime
container_runtime: "containerd"

# Network Configuration
pod_network_cidr: "10.244.0.0/16" # Why we are using this ip range? Because this is the default range used by Calico and Flannel CNI plugins for pod networking.
service_cidr: "10.96.0.0/12" # Why we are using this ip range?  Because this is the default range used by Kubernetes for services.

# Control Plane Configuration
control_plane_endpoint: "192.168.178.34:6443" # Why port 6443? Because this is the default port used by Kubernetes API server.
apiserver_advertise_address: "192.168.178.34"

# CNI Plugin
cni_plugin: "calico"
calico_version: "v3.27.0"
calico_manifest_url: "https://raw.githubusercontent.com/projectcalico/calico/{{ calico_version }}/manifests/calico.yaml"

# Package versions (apt)
containerd_version: "1.7.12-1"

# System configuration
swap_disable: true  # Why disable swap? Because Kubernetes requires swap to be disabled for proper functioning.

# Kernel modules required for Kubernetes
kernel_modules:
  - overlay     # What is overlay? It is a kernel module that allows for overlay filesystems, which are used by container runtimes.
  - br_netfilter # What is br_netfilter? It is a kernel module that allows for network bridge filtering, which is required for Kubernetes networking.

# Sysctl parameters for Kubernetes networking
sysctl_config:
  net.bridge.bridge-nf-call-iptables: 1
  net.bridge.bridge-nf-call-ip6tables: 1
  net.ipv4.ip_forward: 1

# Kubeadm configuration
kubeadm_init_extra_args: ""
kubeadm_join_extra_args: ""

# Directory paths
kubernetes_config_dir: "/etc/kubernetes"
kubernetes_manifest_dir: "/etc/kubernetes/manifests"
kubernetes_pki_dir: "/etc/kubernetes/pki"
kubelet_config_dir: "/var/lib/kubelet"
containerd_config_dir: "/etc/containerd"

# User configuration (non-root user for kubectl access)
kubernetes_user: "{{ k8s_user }}"
kubernetes_user_home: "{{ k8s_user_home }}"